class e{#e;#t;#s;#r;#a={pathToTheSearchableData:void 0,searchFormId:".static-search-form",searchFormInputId:".static-search-query",searchResultsTemplate:void 0,noSearchResultsFoundTemplate:'<p class="no-results-found">...Sorry no search results found</p>',showStaticSearchLogo:!0,highlightKeywords:!0};constructor(e={}){this.#e=Object.assign({},this.#a,e),this.#s=document.querySelector(`${this.#e.searchFormInputId}`),this.#t=document.querySelector(`${this.#e.searchFormId}`),this.#t.addEventListener("mouseover",(async e=>{if(sessionStorage.getItem("searchable-json-data"))this.#r=JSON.parse(sessionStorage.getItem("searchable-json-data"));else try{let e=await fetch(this.#e.pathToTheSearchableData);if(!e.ok)throw"Sorry couldn't fetch the data";this.#r=await e.json(),sessionStorage.setItem("searchable-json-data",JSON.stringify(this.#r))}catch(e){console.log(`Sorry couldn't fetch the data:\nError-code: ${e.code}\nError-message: ${e.message}`)}}),{once:!0}),this.#t.addEventListener("submit",(e=>{e.preventDefault();let t=document.querySelector(".static-search-result");null!=t&&this.#t.removeChild(t);let s=structuredClone(this.#r).filter((e=>{for(let t in e)if(this.#i({word:`${this.#s.value}`,string:e[t]}))return!0;return!1}));this.#e.highlightKeywords&&s.forEach((e=>{for(let t in e)e[t]=this.#n({string:e[t],keyword:`${this.#s.value}`})}));let r=document.createElement("ul");if(r.setAttribute("class","static-search-result"),s.length<=0){let e=document.createElement("li");return e.innerHTML=this.#e.noSearchResultsFoundTemplate,r.prepend(e),this.#t.append(r)}{let e=s.map((e=>{let t=document.createElement("li");return t.setAttribute("class","result-item"),t.innerHTML=this.#e.searchResultsTemplate(e),t.outerHTML})).join("");if(r.innerHTML=e,this.#e.showStaticSearchLogo){let e=document.createElement("li");e.setAttribute("class","static-search-logo"),e.innerHTML='<p>Search provided by <a href="#">static search</a></p>',r.append(e)}this.#t.append(r)}})),document.addEventListener("click",(e=>{if(e.target!==this.#t){let e=document.querySelector(".static-search-result");null!=e&&this.#t.removeChild(e)}}))}#i({word:e,string:t}){return new RegExp(e,"gi").test(t)}#n({string:e,keyword:t}){return e.replace(new RegExp(`${t}`,"ig"),(function(e){return`<mark>${e}</mark>`}))}}export{e as default};
